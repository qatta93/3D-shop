# This workflow will do a clean installation of the dependencies, cache/restore them, build the source code and run tests across different versions of node
# For more information see: https://help.github.com/actions/language-and-framework-guides/using-nodejs-with-github-actions
 
# name: "Deploy CI"
 
# on:
#  release:
#    types:
#      - published
#  push:
#    branches:
#      - master
#  workflow_dispatch:
 
# jobs:
#  vercel:
#    runs-on: ubuntu-latest
#    name: "Deploy application"
  
#    steps:
#      - uses: actions/checkout@v2
#      - uses: actions/setup-node@v1
#        with:
#          node-version: '14'
#          registry-url: https://registry.npmjs.org/
 
#      - name: "Deploy application"
#        run: |
#          prodRun=""
#          if [[ ${GITHUB_REF} == "refs/heads/main" ]]; then
#            prodRun="--prod"
#          fi
 
#          npx vercel --token ${VERCEL_TOKEN} $prodRun
#        env:
#          VERCEL_TOKEN: ${{ secrets.VERCEL_TOKEN }}

name: Deploy
on:
  push:
    branches: [master]
  pull_request:
    types: [opened, synchronize, reopened]
jobs:
  deploy:
    runs-on: ubuntu-latest
    if: "!contains(github.event.head_commit.message, '[skip ci]')"
    steps:
      - name: Checkout
        uses: actions/checkout@v2
      - name: Deploy to Vercel Action
        uses: BetaHuhn/deploy-to-vercel-action@v1
        with:
          GITHUB_TOKEN: ${{ secrets.GH_PAT }}
          VERCEL_TOKEN: ${{ secrets.VERCEL_TOKEN }}
          VERCEL_ORG_ID: ${{ secrets.VERCEL_ORG_ID }}
          VERCEL_PROJECT_ID: ${{ secrets.VERCEL_PROJECT_ID }}